<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<table>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">Field</td>
                                                    <td class="LabTdRight" valign="top">
                                                    <?php 
                                                        if(!empty($facilitydropdown) && count($facilitydropdown)>0){
                                                            foreach ($facilitydropdown as $key => $value) {
                                                    ?>
                                                    <input onchange="get_labcat(this)" type="checkbox" name="field[]" id="field_<?php echo $value['id']; ?>" value="<?php echo $value['id']; ?>">
                                                    <?php 
                                                    echo $value['category_name']."<br>";
                                                                
                                                            }
                                                        } 
                                                    ?>
                                                    </td>
                                                    <td class="LabTdLeft" valign="top">Facility</td>
                                                    <td class="LabTdRight" valign="top">
                                                    <?php 
                                                        if(!empty($operationat) && count($operationat)>0){
                                                            foreach ($operationat as $key => $value) {
                                                    ?>
                                                    <input type="checkbox" name="operationat[]" id="operationat_<?php echo $value['id']; ?>" value="<?php echo $value['operation_name']; ?>">
                                                    <?php 
                                                        echo $value['operation_name']."<br>";
                                                            }
                                                        } 
                                                    ?>
                                                    </td>

                                                    </td>
                                                </tr>

                                                <tr><td colspan="4" height="5px"></td></tr>

                                                <tr>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">Discipline</td>
                                                    <td class="LabTdRight" valign="top">
                                                        <div id='discipline'>
                                                        </div>
                                                    </td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">Group</td>
                                                    <td class="LabTdRight" valign="top">
                                                        <div id='group'>
                                                        </div>
                                                    </td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">Sub Group </td>
                                                    <td class="LabTdRight" valign="top">
                                                        <div id='subgroup'>
                                                        </div>
                                                    </td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">

                                                    </td>
                                                </tr>
                                                <tr><td colspan="4" height="10px"><hr /></td></tr>
                                                <tr>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                    <td class="LabTdLeft" valign="top">&nbsp;</td>
                                                    <td class="LabTdRight" valign="top">&nbsp;</td>
                                                </tr>

                                                <tr><td colspan="4" height="5px"></td></tr>            
                                                <tr>
                                                    <td align="center" colspan="4" valign="top"><center>
                                                    <input type="hidden" name="searchSts" id="searchSts" value="0">
                                                    <input onclick="return get_data(this);" type="button" name="submit" value="Search">
                                                    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
                                                    <input onclick="return get_data(this);" id="export-excel" class="btn btn-primary" name="export-excel" value="Export to excel" type="button">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
                                                    <input type="button" name="button" id="button" value="Reset" onclick="javascript: return resetpage();" />
                                                    </center></td>
                                                </tr>
                                                <tr><td colspan="4" height="5px"></td></tr>
</table>




                                        <table id="rowDataShow" width="100%" border="0" cellpadding="0" cellspacing="0">

                                        </table>

                                        <table width='100%' border='0' cellspacing='0' cellpadding='5'>
                                            <tr>
                                                <td align='left' valign='top' width='100%' id="pagination" >
                                                </td>
                                            </tr>
                                        </table>




<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    $("#search-form").submit(function (event) {
        if ($("#country-dropdown").val() == '0')
        {
            alert("Please select country.");
            return false;
        }
        return true;
    });

$('document').ready(function() {
    //get_data();
});
function resetpage() {
    var servername = '<?php echo base_url(); ?>';
    window.location = "index.php?c=search&m=index";
}
function getCountry(countryid){
    if(countryid=='1'){
        $('#country_row').show();
    } else {
        $('#country_row').hide();
        $('#state,#city').val('-1');
    }
}
function get_data(ths){
    if($('#searchSts').val()=='0'){
        $('#searchSts').val('1');
        var params = {};
        params['lab_registration_code'] = $('#lab_registration_code').val();
        params['labname'] = $('#labname').val();
        params['certificate_no'] = $('#certificate_no').val();
        params['country'] = $('#country').val();
        params['state'] = $('#state').val();
        params['city'] = $('#city').val();
        if($(ths)){
            if($(ths).prop('nodeName')=='A'){
                params['page'] = $(ths).attr('data-href');
            }
        }
        $.ajax({
            url: '<?php echo base_url(); ?>index.php?c=searchlab&m=searchdata',
            data: params,
            type: 'POST',
            dataType: 'json',
            async: false,
            success: function (result) {
                $('#searchSts').val('0');
                if(result.code=='0'){
                    $('#pagination').html('');
                    $('#rowDataShow').html('<tr><td><b>No Record Found</b></td></tr>');
                } else {
                    $('#rowDataShow').html('');
                    if(result.hasOwnProperty('data') && parseInt(result.data.length)>0){
                        $.each(result.data,function(keyPgn,valPgn){
                            $('#templetData .labname_span').text(valPgn.labname);
                            $('#templetData .address_span').text(valPgn.address);
                            $('#templetData .tel_span').text(valPgn.telephone);
                            $('#templetData .fax_span').text(valPgn.fax);
                            $('#templetData .email_span').text(valPgn.email);
                            $('#templetData .con_per_span').text(valPgn.contact_person);
                            $('#templetData .linkopen_span').attr('onclick','return open_win('+valPgn.id+')');                            
                            $('#rowDataShow').append($('#templetData').html());
                        });
                    }

                    $('#pagination').html('');
                    if(result.hasOwnProperty('pagination') && parseInt(result.pagination.length)>0){
                        $.each(result.pagination,function(keyPgn,valPgn){
                            $('#pagination').append('<a onclick="get_data(this)" href="JavaScript:void(0);" class="paginationClass" data-href="'+valPgn.pageUrl+'">'+valPgn.pageText+'</a>');
                        });
                    }
                    
                }
            }
        });
    }


}
function get_labcat(ths){
    var params = {};
    var idsArr=$(ths).attr('id').split('_');
    params['type_data'] = idsArr[0];
    params['search_data'] = $('[id^="'+idsArr[0]+'_"]:checked').map(function() { return this.value; }).get().join(",");

    $.ajax({
        url: '<?php echo base_url(); ?>index.php?c=searchlab&m=searchlabcat',
        data: params,
        type: 'POST',
        dataType: 'json',
        async: false,
        success: function (result) {
            if(result.code==0){
                $('#'+result.target).html(result.data);
            }
            if(result.target=='discipline'){
                $('#group,#subgroup').html('');
            }
            if(result.target=='group'){
                $('#subgroup').html('');
            }
            console.log(result);
        }
    });    
}
</script>
</body>
</html>
